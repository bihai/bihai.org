

{
    "title": "微软纸牌合集资源文件研究",
    "date": "2020-08-19 10:00:47 +0800 CST",
    "type": "featured",
    "permalink" : "https://bihai.org/microsoft-solitaire/",
    "summary" : "成功反编译\u0026quot;微软纸牌集合\u0026quot;资源文件",
     "img" : "/images/masonary-post/post-5.jpg",
        
    "content" :"\u003ch2 id=\"成功反编译微软纸牌集合资源文件\"\u003e成功反编译\u0026quot;微软纸牌集合\u0026quot;资源文件\u003c/h2\u003e\n\u003cp\u003e1989年，微软推出了Windows 2.0图像操作系统，微软纸牌合集(Microsoft Solitaire Collection)开始随windows捆绑，成了大众休闲放松的利器。后来微软将它单独拿出来发扬光大，做出了跨平台的游戏，还是值得一玩，可惜限制比较多，于是乎最近花了一天时间，终于成功反编译了“微软纸牌集合（Microsoft Solitaire Collection）”的资源文件，以及图片集索引逆向转为跨平台json/atlas/texturePacker文件格式，可以直接用于跨平台软件制作，包括网页版，只是作为研究而已，没什么实际意义。至此，微软全平台游戏终于全部解包完毕，包括solitaire, minesweeper等等，还是很有借鉴意义。\n\u003cimg\r\n        class=\"lazyload\"\r\n       style=\"width:100%;hight:auto;\" src=\"https://img-blog.csdnimg.cn/20200819181552183.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        data-srcset=\"https://img-blog.csdnimg.cn/20200819181552183.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center, https://img-blog.csdnimg.cn/20200819181552183.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 1.5x, https://img-blog.csdnimg.cn/20200819181552183.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 2x\"\r\n        data-sizes=\"auto\"\r\n        alt=\"https://img-blog.csdnimg.cn/20200819181552183.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        title=\"在这里插入图片描述\" /\u003e\n\u003cimg\r\n        class=\"lazyload\"\r\n       style=\"width:100%;hight:auto;\" src=\"https://img-blog.csdnimg.cn/2020081918155297.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        data-srcset=\"https://img-blog.csdnimg.cn/2020081918155297.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center, https://img-blog.csdnimg.cn/2020081918155297.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 1.5x, https://img-blog.csdnimg.cn/2020081918155297.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 2x\"\r\n        data-sizes=\"auto\"\r\n        alt=\"https://img-blog.csdnimg.cn/2020081918155297.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        title=\"在这里插入图片描述\" /\u003e\n\u003cimg\r\n        class=\"lazyload\"\r\n       style=\"width:100%;hight:auto;\" src=\"https://img-blog.csdnimg.cn/2020081918155284.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        data-srcset=\"https://img-blog.csdnimg.cn/2020081918155284.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center, https://img-blog.csdnimg.cn/2020081918155284.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 1.5x, https://img-blog.csdnimg.cn/2020081918155284.jpg?x-oss-process=image/watermark%2ctype_ZmFuZ3poZW5naGVpdGk%2cshadow_10%2ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy%2csize_16%2ccolor_FFFFFF%2ct_70#pic_center 2x\"\r\n        data-sizes=\"auto\"\r\n        alt=\"https://img-blog.csdnimg.cn/2020081918155284.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RocmlsbGVy,size_16,color_FFFFFF,t_70#pic_center\"\r\n        title=\"在这里插入图片描述\" /\u003e\u003c/p\u003e\n\u003ch2 id=\"文件格式说明\"\u003e文件格式说明\u003c/h2\u003e\n\u003cp\u003e微软纸牌采用BR****I算法的zip压缩文件格式作为资源文件包，图集atlasIndex索引是加密（或者说是编译）的二进制文件，不知道是不是笔者孤陋寡闻，没有找到相关资料，只好用ultralEdit/vb6/vscode分析了一天，终于凑合转为JSON文件格式，好看好用多了:)。\nzip文件格式应该不用多说，但是用普通的解压缩软件解不开这些.archive文件，只好又写了一个专用的解包工具，牵扯版权就不发了。\natlasIndex文件格式比较复杂，主要如下：\u003c/p\u003e\n\u003ch3 id=\"1-文件头8字节\"\u003e1. 文件头8字节\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre class=\"chroma\"\u003e\u003ccode class=\"language-vbnet\" data-lang=\"vbnet\"\u003e\u003cspan class=\"c\"\u003e\u0026#39;atlas.atlasindex文件格式说明\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026#39;atlas.atlasindex file format specification\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026#39;Offset      0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026#39;00000000   68 2E 00 00 B4 30 00 00  00 00 00 00 00 00 00 00   h.  ?\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"n\"\u003eTAtlasHeader\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elOffsetTable\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eLong\u003c/span\u003e \u003cspan class=\"c\"\u003e\u0026#39;\u0026amp;h2e68\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003elOffsetNamelist\u003c/span\u003e \u003cspan class=\"ow\"\u003eAs\u003c/span\u003e \u003cspan class=\"kt\"\u003eLong\u003c/span\u003e \u003cspan class=\"c\"\u003e\u0026#39;\u0026amp;h30b4\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"n\"\u003eType\u003c/span\u003e \u003cspan class=\"c\"\u003e\u0026#39;TAtlasHeader\n\u003c/span\u003e\u003cspan class=\"c\"\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e第一个长整数\u0026amp;h2e68是索引表的偏移量位置，第二个整数\u0026amp;h30b4是名称列表。\u003c/p\u003e\n\u003ch3 id=\"2-h70偏移开始表结构的索引各种跳转实在是一言难尽啊抽空整理一下vb6源代码估计感兴趣的也不多\"\u003e2. \u0026amp;h70偏移开始表结构的索引，各种跳转，实在是一言难尽啊，抽空整理一下VB6源代码，估计感兴趣的也不多。\u003c/h3\u003e\n\u003cp\u003e以上抛砖引玉，主要还是知识浅薄，孤陋寡闻，不知道是不是已经有人做了，纯粹业余兴趣，如果侵犯版权或者有其他错误请批评指正。\u003c/p\u003e\n\u003cp\u003eWelcome to \u003ca href=\"https://bihai.org\"\u003ehttps://bihai.org\u003c/a\u003e!\u003c/p\u003e"}