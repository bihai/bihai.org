

{
    "title": "shell 脚本中经常要用到ssh。怎么能不交互的输密码呢？",
    "date": "0001-01-01 00:00:00 +0000 UTC",
    "type": "posts",
    "permalink" : "https://bihai.org/shell-%E8%84%9A%E6%9C%AC%E4%B8%AD%E7%BB%8F%E5%B8%B8%E8%A6%81%E7%94%A8%E5%88%B0ssh%E6%80%8E%E4%B9%88%E8%83%BD%E4%B8%8D%E4%BA%A4%E4%BA%92%E7%9A%84%E8%BE%93%E5%AF%86%E7%A0%81%E5%91%A2/",
    "summary" : "1、登录A机器 2、 ssh-keygen -t [rsa|dsa] ，将会在~/.ssh下生成密钥文件和私钥文件 id_rsa,id_rs",
     "img" : "https:/bihai.org/images/masonary-post/post-2.jpg",
        
    "content" :"\u003cp\u003e1、登录A机器\u003cbr\u003e\n2、 \u003ccode\u003essh-keygen -t [rsa|dsa]\u003c/code\u003e ，将会在~/.ssh下生成密钥文件和私钥文件 \u003ccode\u003eid_rsa,id_rsa.pub\u003c/code\u003e 或\n\u003ccode\u003eid_dsa,id_dsa.pub\u003c/code\u003e\u003cbr\u003e\n3、将 \u003ccode\u003e.pub\u003c/code\u003e 文件复制到B机器的 \u003ccode\u003e.ssh\u003c/code\u003e 目录， 并\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecat id_dsa.pub \u0026gt;\u0026gt; ~/.ssh/authorized_keys\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e4、大功告成，从A机器登录B机器的目标账户，不再需要密码了（直接运行 \u003ccode\u003e#ssh 192.168.1.100\u003c/code\u003e ）\u003c/p\u003e\n\u003cp\u003e面交互输入，就得使用 \u003ccode\u003eexpect\u003c/code\u003e 脚本，例:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#!/bin/bash\n passwd='123456'\n /usr/bin/expect \u0026lt;\u0026lt;-EOF\n set time 30\n spawn ssh  root@192.168.1.100\n expect {\n \u0026quot;*yes/no\u0026quot; { send \u0026quot;yes\\r\u0026quot;; exp_continue }\n \u0026quot;*password:\u0026quot; { send \u0026quot;$passwd\\r\u0026quot; }\n }\n expect \u0026quot;*#\u0026quot;\n send \u0026quot;cd /home/trunk\\r\u0026quot;\n expect \u0026quot;*#\u0026quot;\n send \u0026quot;ls\\r\u0026quot;\n expect \u0026quot;*#\u0026quot;\n send \u0026quot;exit\\r\u0026quot;\n interact\n expect eof\n EOF\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"javascript:;\" rel=\"\"\u003e 点赞  3  \u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"javascript:;\" rel=\"\"\u003e 收藏  \u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"javascript:;\" rel=\"\"\u003e 分享 \u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cpre\u003e\u003ccode\u003e* 文章举报 \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e \u003cimg\r\n        class=\"lazyload\"\r\n       style=\"width:100%;hight:auto;\" src=\"https://profile.csdnimg.cn/2/1/1/3_thriller\"\r\n        data-srcset=\"https://profile.csdnimg.cn/2/1/1/3_thriller, https://profile.csdnimg.cn/2/1/1/3_thriller 1.5x, https://profile.csdnimg.cn/2/1/1/3_thriller 2x\"\r\n        data-sizes=\"auto\"\r\n        alt=\"https://profile.csdnimg.cn/2/1/1/3_thriller\"\r\n        title=\"https://profile.csdnimg.cn/2/1/1/3_thriller\" /\u003e\n\u003ca href=\"https://blog.csdn.net/thriller\" target=\"_blank\" rel=\"noopener noreffer\"\u003e\u003cimg\r\n        class=\"lazyload\"\r\n       style=\"width:100%;hight:auto;\" src=\"https://g.csdnimg.cn/static/user-reg-year/1x/20.png\"\r\n        data-srcset=\"https://g.csdnimg.cn/static/user-reg-year/1x/20.png, https://g.csdnimg.cn/static/user-reg-year/1x/20.png 1.5x, https://g.csdnimg.cn/static/user-reg-year/1x/20.png 2x\"\r\n        data-sizes=\"auto\"\r\n        alt=\"https://g.csdnimg.cn/static/user-reg-year/1x/20.png\"\r\n        title=\"https://g.csdnimg.cn/static/user-reg-year/1x/20.png\" /\u003e\n\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/thriller\" target=\"_blank\" rel=\"noopener noreffer\"\u003e thriller \u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e发布了19 篇原创文章  ·  获赞 18  ·  访问量 5万+\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://im.csdn.net/im/main.html?userName=thriller\" target=\"_blank\" rel=\"noopener noreffer\"\u003e 私信 \u003c/a\u003e 关注\u003c/p\u003e\n"}